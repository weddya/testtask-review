## Ревью проекта

Ну для начала могу сказать, что архитектура в целом неплохая, есть системный подход и движение в правильном направлении. Понравились неймспейсы по стандартам, type hints, readonly, strict_types, разделение на слои Контроллеров, Доменов, Репо, Инфры и Вьюшек.  
Замечания:
- Отдельные контроллеры на действия с одной сущностью (AddToCartController и GetCartController).

### Controller/AddToCartController.php
- Неочевидный метод get() => Нужно переименовать в add().
- Всегда возвращаем 200 статус код и в body - success status, даже если не получится добавить товар в корзину. Хардкод значений.
- Нет обработки ошибок и логирования.
- GetProductsController: Не хватает валидации, хотя бы самой простой на заполненность данных и тип в запросах к нашим енд-поинтам. Упс, увидел, что в ридми это было.
- Не хватает валидации сессии, если только это не реализовано силами условного фреймворка.
- Не хватает strict_types, который задекларирован почти везде в проекте.

### Controller/GetCartController.php
- Всегда возращаем 404 статус независимо от остальной логики.
- Лишний request в аргументах, мы его никак не используем.
- Не хватает валидации сессии, если только это не реализовано силами условного фреймворка.
- Свойства наружу нам не нужны, исправить public => private.
- Немного разобщены json-ответы для ошибки и для успешного запроса.

### Controller/GetProductsController.php
- Нет проверки на наличие данных в $rawRequest, соответственно неизвестно получим ли из json_decode что-то и сможем ли обратиться к $rawRequest['category'] или упадем. Но, наверное, стоит опять это на совесть фреймворка оставить по условию.
- Опечатка в свойстве "productsVew"

### Domain/Cart.php
- Проблема с тем, что по идее мы хотим иммутабельность сохранять. А в addItem() методе теряем её. По-хорошему тут возвращаем новый инстанс Cart с новыми items. Ну и чтобы избавиться от смеси из readonly свойств и мутабельных, добавляем readonly к items.
- Можно добавить метод для вычисления total, он нам пригодится.
- По логике еще не хватает методов для удаления товаров из корзины и очистки корзины, но, возможно, в данную задачу это не входит.

### Domain/CartItem.php
- Хочется здесь добавить код на случай отрицательных price и quantity.
- Свойства сделать private, геттеры у нас есть, сеттеры не нужны - класс readonly.
- Добавить метод вычисления total.

### Domain/Customer.php
- Добавить метод getFullName, пригодится.

### Repository/ProductRepository.php
- Не экранированы данные в запросах, риск sql инъекций.
- и весь проект: Вместо общего типа Exception на всё, хочется разных типизированных, которые контекст имеют.
- getByCategory неверно работает. Запрашивает только id из бд, а в make нам нужны все данные о товаре.
- Не отлавливаются неудачные запросы к бд.

### Repository/CartManager.php
- Расширяет ConnectorFacade вместо композиции.
- Ошибки с аргументами в $this->connector->set() и в new Cart().
- Логгирование ошибок без подробностей.
- У методов не объявлен тип возвращаемого значения.
- Свойство logger лучше сделать приватным.
- dbindex захардкожен, лучше вынести в константы/конфиги, либо в дефолтные значения фасада, если пока предполагается только один индекс.

### Infrastructure/Connector.php
- Некорректный конструктор, он не должен возвращать значений. 
- Все перепутано во взаимодействии с редис. Как будто в роли ключа пытались использовать session_id(), а в виде значения - Cart, но все перепутано везде. Кроме того, коннектор не должен ничего знать о Cart.
- Нужно вынести TTL корзины за пределы коннектора.
- Методы под перезапись под требования задачи. Нет проверок доступности, нет логирования ошибок.
- Добавить недостающие типы аргументов и возвращаемых значений.
- has функция устаревшая. Метод exists у phpredis возвращал bool для версий <4.0.0. У нас в композере *, мы 6.2.0 добавим в проект.

### Infrastructure/ConnectorException.php
- Не учитывается nullable свойство previous.

### Infrastructure/ConnectorFacade.php
- Не хватает type hint'ов в конструкторе, свойства public вместо private.
- Лучше вообще вытащить конфиги в отдельный класс.
- Доступ к connector не по public свойству, а с помощью метода getConnector().
- Переписать build метод, подключение из конфигов, вычистить isConnected hell, обрабатывать исключения.
- Нет retry или fallback

### View/CartView.php
- Запросы товаров в цикле.
- Пофиксить подсчет total для отдельных item'ов, он накапливается со временем. Использовать total() из Cart и CartItem.
- Избавиться от implode(), использовать getFullName() из Customer.

### View/ProductsView.php
- Добавить strict_types, в соответствии со всем проектом.
- Добавить обработку ошибок для несуществующей категории и ошибок ДБ.
- Для больших объемов товаров нужна еще пагинация и кеширование.

